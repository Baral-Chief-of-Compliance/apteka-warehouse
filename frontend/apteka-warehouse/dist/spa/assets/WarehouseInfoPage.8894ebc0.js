import{a as s}from"./QBtn.e9a2bcf7.js";import{Q,a as V,b as $,c as M,d as q,e as B,C as N}from"./ClosePopup.064329ac.js";import{Q as z,a as A}from"./QCard.246add5a.js";import{Q as D}from"./QPage.fb1668d3.js";import{i as u,A as P,af as T,Z as W,y as I,B as n,C as i,D as r,a as _,F as d,E as p,K as t,H as f,I as h,L as w,G as m,M as R,N as E,z as F}from"./index.4c705956.js";import"./render.9b0eaa5f.js";import"./dom.b5015e69.js";import"./use-dark.371bb89c.js";import"./QItem.234b9042.js";import"./scroll.f2648681.js";const H={class:"column text-center text-h6"},L={class:"q-mt-xl"},S={key:0,class:"text-center text-h5 text-italic text-grey"},U=t("span",null,"\u041D\u0430 \u0434\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 \u043D\u0435\u0442\u0443 \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u043E\u0432",-1),j=[U],G={key:1},K={class:"q-mt-xl column"},Z={class:"row"},J=t("span",{class:"q-ma-sm text-h5"},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B \u043D\u0430 \u0441\u043A\u043B\u0430\u0434",-1),O={class:"column q-mt-md"},ie={__name:"WarehouseInfoPage",setup(X){const{getMed:v}=u("med");u("role");const{checkRightsAdminManagerPhManager:b}=u("role"),x=P(),C=T(),a=W({w_id:null,w_address:null,w_director:null,w_phone_number:null,medication:[],all_medication:[],selected_med:[],addCard:!1,columns:[{name:"med_id",required:!0,label:"\u0418\u043D\u0434\u0435\u043A\u0441",align:"center",field:e=>e.med_id,format:e=>`${e}`,sortable:!0},{name:"med_name",align:"center",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",field:e=>e.med_name,sortable:!0},{name:"med_category",align:"center",label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",field:e=>e.med_catagory,sortable:!0},{name:"med_dosage",align:"center",label:"\u0414\u043E\u0437\u0430",field:e=>e.med_dosage,sortable:!0},{name:"med_price",align:"center",label:"\u0426\u0435\u043D\u0430(\u0440\u0443\u0431.)",field:e=>e.med_price,sortable:!0},{name:"med_expiration_date",align:"center",label:"\u0418\u0441\u0442\u0435\u0447\u0435\u043D\u0438\u0435 \u0441\u0440\u043E\u043A\u0430 \u0433\u043E\u0434\u043D\u043E\u0441\u0442\u0438",field:e=>e.med_expiration_date,sortable:!0},{name:"med_receipts",align:"center",label:"\u0414\u0430\u0442\u0430 \u043F\u043E\u0441\u0442\u0443\u043F\u043B\u0435\u043D\u0438\u044F",field:e=>e.med_receipts,sortable:!0},{name:"s_name",align:"center",label:"\u041F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A",field:e=>e.s_name,sortable:!0},{name:"delete",label:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u0430",align:"center"}]});function c(){_.get(`https://zdorovie.space/api/v1/warehouse/${C.params.w_id}`).then(e=>{a.w_id=e.data.warehouse_info.w_id,a.w_address=e.data.warehouse_info.w_address,a.w_director=e.data.warehouse_info.w_director,a.w_phone_number=e.data.warehouse_info.w_phone_number,a.medication=e.data.medications})}function k(){for(let e=0;e<a.selected_med.length;e++)_.post("https://zdorovie.space/api/v1/medication-warehouse",{w_id:a.w_id,med_id:a.selected_med[e]});a.addCard=!1,c()}function y(e){_.delete(`https://zdorovie.space/api/v1/medication-warehouse/${a.w_id}-${e}`).then(async()=>{c()})}return I(async()=>{c(),a.all_medication=await v()}),(e,o)=>(n(),i(D,{class:"q-pa-md"},{default:r(()=>[d(s,{color:"primary",icon:"warehouse",label:"\u041A \u0441\u043A\u043B\u0430\u0434\u0430\u043C",onClick:o[0]||(o[0]=l=>p(x).push({name:"Warehouse"}))}),t("div",H,[t("span",null,[f("\u0421\u043A\u043B\u0430\u0434 \u043F\u043E \u0430\u0434\u0440\u0435\u0441\u0443: "),t("b",null,h(a.w_address),1)]),t("span",null,[f("\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430: "),t("b",null,h(a.w_phone_number),1)]),t("span",null,[f("\u0414\u0438\u0440\u0435\u043A\u0442\u043E\u0440: "),t("b",null,h(a.w_director),1)])]),t("div",L,[a.medication.length==0?(n(),w("div",S,j)):m("",!0),a.medication.length!=0?(n(),w("div",G,[d(V,{title:"\u041C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435",rows:a.medication,columns:a.columns,"row-key":"name"},{"body-cell-delete":r(l=>[d(Q,{props:l},{default:r(()=>[p(b)()?(n(),i(s,{key:0,color:"red",icon:"delete",onClick:g=>y(l.row.med_id)},null,8,["onClick"])):m("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])):m("",!0)]),t("div",K,[p(b)()?(n(),i(s,{key:0,color:"green",icon:"add",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u043E\u0432 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434",onClick:o[1]||(o[1]=l=>(a.addCard=!0,a.selected_med=[]))})):m("",!0)]),d(q,{modelValue:a.addCard,"onUpdate:modelValue":o[4]||(o[4]=l=>a.addCard=l),persistent:""},{default:r(()=>[d(z,null,{default:r(()=>[d(A,{class:"column"},{default:r(()=>[t("div",Z,[d($,{icon:"medication",color:"green","text-color":"white"}),J]),t("div",O,[(n(!0),w(E,null,R(a.all_medication,l=>(n(),i(B,{key:l.med_id,val:l.med_id,modelValue:a.selected_med,"onUpdate:modelValue":o[2]||(o[2]=g=>a.selected_med=g),label:l.med_name},null,8,["val","modelValue","label"]))),128))])]),_:1}),d(M,{align:"right"},{default:r(()=>[F(d(s,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"red"},null,512),[[N]]),a.selected_med.length!=0?(n(),i(s,{key:0,flat:"",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",color:"green",onClick:o[3]||(o[3]=l=>k())})):m("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ie as default};
