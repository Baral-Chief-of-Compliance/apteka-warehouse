import{a as n}from"./QBtn.e62c2945.js";import{Q as p,a as q,b as C,c as V,d as k,C as O}from"./ClosePopup.3791ff27.js";import{Q as f,a as b}from"./QCard.740ecce4.js";import{Q as _}from"./QRadio.60cc9fbc.js";import{Q}from"./QInput.82679288.js";import{Q as N}from"./QPage.1d4a5116.js";import{i as w,Z as L,y as E,B as s,C as u,D as o,a as c,L as g,G as i,F as d,E as S,K as r,M as F,N as R,H as x,I as y,z as P}from"./index.01f3f215.js";import"./render.5369a479.js";import"./dom.9e0a715e.js";import"./use-dark.9ed0a3a8.js";import"./QItem.eab1b99a.js";import"./scroll.7e6533da.js";const j={key:0,class:"text-center text-h5 text-italic text-grey"},G=r("span",null,"\u041D\u0430 \u0434\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 \u0437\u0430\u043A\u0430\u0437\u043E\u0432 \u043D\u0435\u0442",-1),H=[G],K={key:1},J={key:2,class:"column"},W=r("span",{class:"q-ma-sm text-h5"},"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u0437\u0430\u043A\u0430\u0437",-1),X=r("span",{class:"q-ma-xl text-h6"},"\u0428\u0410\u0413 1: \u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0430\u043F\u0442\u0435\u043A\u0443 \u0434\u043B\u044F \u0437\u0430\u043A\u0430\u0437\u0430",-1),Y={class:"column"},ee=r("b",null,"\u0410\u0434\u0440\u0435\u0441: ",-1),te=r("b",null," \u0414\u0438\u0440\u0435\u043A\u0442\u043E\u0440: ",-1),le=r("b",null," \u0422\u0435\u043B\u0435\u0444\u043E\u043D: ",-1),ae={key:0},de=r("span",{class:"q-ma-xl text-h6"},"\u0428\u0410\u0413 2: \u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B",-1),oe={class:"column q-mt-md"},re={class:"row"},se=r("span",{class:"q-ma-sm text-h5"},"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u043A\u0430\u0437\u0430",-1),ne={class:"column q-mt-xl"},ie={class:"row"},ue=r("span",{class:"q-ma-sm text-h5"},"\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0434\u0430\u0442\u0443 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438",-1),me={class:"column"},ce={class:"row"},pe=r("span",{class:"q-ma-sm text-h5"},"\u0414\u0435\u0442\u0430\u043B\u0438 \u0437\u0430\u043A\u0430\u0437\u043E\u0432",-1),_e={class:"q-mt-xl"},he={class:"text-h5 q-ma-xs"},Pe={__name:"OrderPage",setup(fe){const{getPharmacy:U}=w("pharmacy"),{getMed:D}=w("med");w("role");const{checkRightsAdminManagerPhManager:v}=w("role"),e=L({updateStatusCard:!1,updateDateCard:!1,detailOrderCard:!1,addCard:!1,pharmacy:[],medication:[],selected_med:[],dateShipment:null,selectedStatus:null,selectedOrderId:null,selectPharmacy:null,orderId:null,orders:[],medicationsInOrder:[],amountPrice:0,columnsMedicationInOrder:[{name:"med_name",align:"center",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",field:l=>l.med_name,sortable:!0},{name:"med_catagory",align:"center",label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",field:l=>l.med_catagory,sortable:!0},{name:"med_dosage",align:"center",label:"\u0414\u043E\u0437\u0430",field:l=>l.med_dosage,sortable:!0},{name:"med_price",align:"center",label:"\u0426\u0435\u043D\u0430 \u0437\u0430 \u0448\u0442.(\u0440\u0443\u0431)",field:l=>l.med_price,sortable:!0},{name:"med_expiration_date",align:"center",label:"\u0418\u0441\u0442\u0435\u0447\u0435\u043D\u0438\u0435 \u0441\u0440\u043E\u043A\u0430 \u0433\u043E\u0434\u043D\u043E\u0441\u0442\u0438",field:l=>l.med_expiration_date,sortable:!0},{name:"med_receipts",align:"center",label:"\u0414\u0430\u0442\u0430 \u043F\u043E\u0441\u0442\u0443\u043F\u043B\u0435\u043D\u0438\u044F",field:l=>l.med_receipts,sortable:!0},{name:"med_quantity",align:"center",label:"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0432 \u0437\u0430\u043A\u0430\u0437\u0435",field:l=>l.med_quantity,sortable:!0},{name:"med_amount_price",align:"center",label:"\u0421\u0443\u043C\u043C\u0430",field:l=>l.med_amount_price,sortable:!0}],columnsOrders:[{name:"ph_od_date",align:"center",label:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",field:l=>l.ph_od_date,sortable:!0},{name:"ph_od_date_shipment",align:"center",label:"\u0414\u0430\u0442\u0430 \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438",field:l=>l.ph_od_date_shipment,sortable:!0},{name:"ph_od_status",align:"center",label:"\u0421\u0442\u0430\u0442\u0443\u0441",field:l=>l.ph_od_status,sortable:!0},{name:"ph_name",align:"center",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0430\u043F\u0442\u0435\u043A\u0438",field:l=>l.ph_name,sortable:!0},{name:"ph_address",align:"center",label:"\u0410\u0434\u0440\u0435\u0441 \u0430\u043F\u0442\u0435\u043A\u0438",field:l=>l.ph_address,sortable:!0},{name:"ph_phone_number",align:"center",label:"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",field:l=>l.ph_phone_number,sortable:!0},{name:"delete",align:"center",label:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435"},{name:"updateStatus",align:"center",label:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u0430"},{name:"updateDate",align:"center",label:"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u0434\u0430\u0442\u044B \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438"},{name:"details",align:"center",label:"\u0414\u0435\u0442\u0430\u043B\u0438 \u0437\u0430\u043A\u0430\u0437\u0430"}],columns:[{name:"med_name",align:"center",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",field:l=>l.med_name,sortable:!0},{name:"quantity",align:"center",label:"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E",field:l=>l.quantity,sortable:!0},{name:"med_price",align:"center",label:"\u0426\u0435\u043D\u0430 (\u0440\u0443\u0431)",field:l=>l.med_price,sortable:!0}]});function $(){e.selectPharmacy=null,e.selected_med=[],e.addCard=!1}function z(l,a){return l*a}function M(){c.post("https://zdorovie.space/api/v1/orders",{ph_od_date:"2024-05-19T16:55:09.690Z",ph_od_date_shipment:"2024-05-19T16:55:09.690Z",ph_od_status:"\u0421\u043E\u0437\u0434\u0430\u043D",pharmacyid:e.selectPharmacy}).then(l=>{e.orderId=l.data.ph_od_id;for(let a=0;a<e.selected_med.length;a++)c.post("https://zdorovie.space/api/v1/medication-order",{med_id:e.selected_med[a].med_id,ph_od_id:e.orderId,quantity:e.selected_med[a].quantity});e.selectPharmacy=null,e.selected_med=[],e.orderId=null,e.addCard=!1,h()})}function h(){c.get("https://zdorovie.space/api/v1/orders",{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(l=>{e.orders=l.data.orders}).catch(function(l){returnToLigonPage()})}function T(l){c.delete(`https://zdorovie.space/api/v1/orders/${l}`).then(a=>{h()})}function B(l){c.get(`https://zdorovie.space/api/v1/orders/${l}/details`).then(a=>{e.amountPrice=a.data.amountPrice,e.medicationsInOrder=a.data.medications,e.detailOrderCard=!0})}function A(){c.put("https://zdorovie.space/api/v1/orders/shipment-date",{ph_od_id:e.selectedOrderId,ph_od_date:"2024-05-19T17:55:23.906Z",ph_od_date_shipment:e.dateShipment,ph_od_status:"\u0421\u043E\u0437\u0434\u0430\u043D",pharmacyid:0}).then(l=>{h(),e.updateDateCard=!1})}function Z(){c.put("https://zdorovie.space/api/v1/orders/status",{ph_od_id:e.selectedOrderId,ph_od_date:"2024-05-19T17:55:23.906Z",ph_od_date_shipment:"2024-05-19T17:55:23.906Z",ph_od_status:e.selectedStatus,pharmacyid:0}).then(l=>{h(),e.updateStatusCard=!1})}function I(l){return e.selectedOrderId=l,!0}return E(async()=>{e.pharmacy=await U(),e.medication=await D(),h()}),(l,a)=>(s(),u(N,{class:"q-pa-md"},{default:o(()=>[e.orders.length==0?(s(),g("div",j,H)):i("",!0),e.orders.length!=0?(s(),g("div",K,[d(q,{title:"\u0417\u0430\u043A\u0430\u0437\u044B",rows:e.orders,columns:e.columnsOrders,"row-key":"name"},{"body-cell-delete":o(t=>[d(p,{props:t},{default:o(()=>[S(v)()?(s(),u(n,{key:0,color:"red",icon:"delete",onClick:m=>T(t.row.ph_od_id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),"body-cell-updateStatus":o(t=>[d(p,{props:t},{default:o(()=>[S(v)()?(s(),u(n,{key:0,color:"orange",icon:"toc",onClick:m=>e.updateStatusCard=I(t.row.ph_od_id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),"body-cell-updateDate":o(t=>[d(p,{props:t},{default:o(()=>[S(v)()?(s(),u(n,{key:0,color:"orange",icon:"schedule",onClick:m=>e.updateDateCard=I(t.row.ph_od_id)},null,8,["onClick"])):i("",!0)]),_:2},1032,["props"])]),"body-cell-details":o(t=>[d(p,{props:t},{default:o(()=>[d(n,{color:"primary",icon:"info",onClick:m=>B(t.row.ph_od_id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])):i("",!0),S(v)()?(s(),g("div",J,[d(n,{color:"green",icon:"add",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437",onClick:a[0]||(a[0]=t=>e.addCard=!0)})])):i("",!0),d(k,{modelValue:e.addCard,"onUpdate:modelValue":a[5]||(a[5]=t=>e.addCard=t),persistent:""},{default:o(()=>[d(f,{class:"col-8"},{default:o(()=>[d(b,{class:"column"},{default:o(()=>[r("div",null,[d(C,{icon:"circle",color:"green","text-color":"white"}),W]),r("div",null,[X,r("div",Y,[(s(!0),g(R,null,F(e.pharmacy,t=>(s(),u(_,{class:"q-my-md",key:t.ph_id,val:t.ph_id,modelValue:e.selectPharmacy,"onUpdate:modelValue":a[1]||(a[1]=m=>e.selectPharmacy=m)},{default:o(()=>[d(f,{class:"",style:{width:"350px"}},{default:o(()=>[d(b,null,{default:o(()=>[r("div",null,[ee,x(y(t.ph_address),1)]),r("div",null,[te,x(" "+y(t.ph_address),1)]),r("div",null,[le,x(" "+y(t.ph_phone_number),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["val","modelValue"]))),128))])]),e.selectPharmacy!=null?(s(),g("div",ae,[de,r("div",oe,[d(q,{color:"primary",title:"\u041C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B",rows:e.medication,columns:e.columns,"row-key":"med_id",selection:"multiple",selected:e.selected_med,"onUpdate:selected":a[2]||(a[2]=t=>e.selected_med=t)},{"body-cell-quantity":o(t=>[d(p,{props:t},{default:o(()=>[d(Q,{min:"1",modelValue:t.row.quantity,"onUpdate:modelValue":m=>t.row.quantity=m,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),"body-cell-med_price":o(t=>[d(p,{props:t},{default:o(()=>[x(y(z(t.row.quantity,t.row.med_price)),1)]),_:2},1032,["props"])]),_:1},8,["rows","columns","selected"])])])):i("",!0)]),_:1}),d(V,{align:"right"},{default:o(()=>[d(n,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"red",onClick:a[3]||(a[3]=t=>$())}),e.selectPharmacy!=null&&e.selected_med.length!=0?(s(),u(n,{key:0,flat:"",label:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",color:"green",onClick:a[4]||(a[4]=t=>M())})):i("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),d(k,{modelValue:e.updateStatusCard,"onUpdate:modelValue":a[12]||(a[12]=t=>e.updateStatusCard=t),persistent:""},{default:o(()=>[d(f,null,{default:o(()=>[d(b,{class:"items-center"},{default:o(()=>[r("div",re,[d(C,{icon:"toc",color:"orange","text-color":"white"}),se]),r("div",ne,[d(_,{modelValue:e.selectedStatus,"onUpdate:modelValue":a[6]||(a[6]=t=>e.selectedStatus=t),val:"\u0412 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435",label:"\u0412 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435"},null,8,["modelValue"]),d(_,{modelValue:e.selectedStatus,"onUpdate:modelValue":a[7]||(a[7]=t=>e.selectedStatus=t),val:"\u0421\u0431\u043E\u0440\u043A\u0430",label:"\u0421\u0431\u043E\u0440\u043A\u0430"},null,8,["modelValue"]),d(_,{modelValue:e.selectedStatus,"onUpdate:modelValue":a[8]||(a[8]=t=>e.selectedStatus=t),val:"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D",label:"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D"},null,8,["modelValue"]),d(_,{modelValue:e.selectedStatus,"onUpdate:modelValue":a[9]||(a[9]=t=>e.selectedStatus=t),val:"\u0414\u043E\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u043E",label:"\u0414\u043E\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u043E"},null,8,["modelValue"]),d(_,{modelValue:e.selectedStatus,"onUpdate:modelValue":a[10]||(a[10]=t=>e.selectedStatus=t),val:"\u041E\u0442\u043C\u0435\u043D\u0435\u043D",label:"\u041E\u0442\u043C\u0435\u043D\u0435\u043D"},null,8,["modelValue"])])]),_:1}),d(V,{align:"right"},{default:o(()=>[P(d(n,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"red"},null,512),[[O]]),e.selectedStatus!=null?(s(),u(n,{key:0,flat:"",label:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",color:"orange",onClick:a[11]||(a[11]=t=>Z())})):i("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),d(k,{modelValue:e.updateDateCard,"onUpdate:modelValue":a[15]||(a[15]=t=>e.updateDateCard=t),persistent:""},{default:o(()=>[d(f,null,{default:o(()=>[d(b,{class:"items-center"},{default:o(()=>[r("div",ie,[d(C,{icon:"schedule",color:"orange","text-color":"white"}),ue]),d(Q,{modelValue:e.dateShipment,"onUpdate:modelValue":a[13]||(a[13]=t=>e.dateShipment=t),type:"date",label:"\u0414\u0430\u0442\u0430 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438"},null,8,["modelValue"])]),_:1}),d(V,{align:"right"},{default:o(()=>[P(d(n,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"red"},null,512),[[O]]),e.dateShipment!=null?(s(),u(n,{key:0,flat:"",label:"\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C",color:"orange",onClick:a[14]||(a[14]=t=>A())})):i("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),d(k,{modelValue:e.detailOrderCard,"onUpdate:modelValue":a[16]||(a[16]=t=>e.detailOrderCard=t),persistent:""},{default:o(()=>[d(f,{class:"col-6"},{default:o(()=>[d(b,{class:"row items-center"},{default:o(()=>[r("div",me,[r("div",ce,[d(C,{icon:"info",color:"primary","text-color":"white"}),pe]),r("div",_e,[d(q,{title:"\u041C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B \u0432 \u0437\u0430\u043A\u0430\u0437\u0435",rows:e.medicationsInOrder,columns:e.columnsMedicationInOrder,"row-key":"name"},null,8,["rows","columns"]),r("div",he,"\u0421\u0443\u043C\u043C\u0430 \u0437\u0430\u043A\u0430\u0437\u0430: "+y(e.amountPrice)+" \u0440\u0443\u0431.",1)])])]),_:1}),d(V,{align:"right"},{default:o(()=>[P(d(n,{flat:"",label:"\u041D\u0430\u0437\u0430\u0434",color:"red"},null,512),[[O]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Pe as default};
