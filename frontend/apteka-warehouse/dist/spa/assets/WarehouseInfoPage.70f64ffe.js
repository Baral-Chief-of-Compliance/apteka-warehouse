import{a as s}from"./QBtn.e62c2945.js";import{Q,a as V,b as $,c as B,d as M,e as q,C as z}from"./ClosePopup.3791ff27.js";import{Q as A,a as N}from"./QCard.740ecce4.js";import{Q as P}from"./QPage.1d4a5116.js";import{i as u,A as T,af as D,Z as I,y as W,B as n,C as i,D as r,a as _,F as d,E as p,K as t,H as h,I as f,L as g,G as c,M as L,N as R,z as S}from"./index.01f3f215.js";import"./render.5369a479.js";import"./dom.9e0a715e.js";import"./use-dark.9ed0a3a8.js";import"./QItem.eab1b99a.js";import"./scroll.7e6533da.js";const E={class:"column text-center text-h6"},F={class:"q-mt-xl"},H={key:0,class:"text-center text-h5 text-italic text-grey"},U=t("span",null,"\u041D\u0430 \u0434\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 \u043D\u0435\u0442\u0443 \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u043E\u0432",-1),j=[U],G={key:1},K={class:"q-mt-xl column"},Z={class:"row"},J=t("span",{class:"q-ma-sm text-h5"},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B \u043D\u0430 \u0441\u043A\u043B\u0430\u0434",-1),O={class:"column q-mt-md"},ie={__name:"WarehouseInfoPage",setup(X){const{getMed:v}=u("med");u("role");const{checkRightsAdminManagerPhManager:w}=u("role"),x=T(),C=D(),a=I({w_id:null,w_address:null,w_director:null,w_phone_number:null,medication:[],all_medication:[],selected_med:[],addCard:!1,columns:[{name:"med_id",required:!0,label:"\u0418\u043D\u0434\u0435\u043A\u0441",align:"center",field:e=>e.med_id,format:e=>`${e}`,sortable:!0},{name:"med_name",align:"center",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",field:e=>e.med_name,sortable:!0},{name:"med_category",align:"center",label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",field:e=>e.med_catagory,sortable:!0},{name:"med_dosage",align:"center",label:"\u0414\u043E\u0437\u0430",field:e=>e.med_dosage,sortable:!0},{name:"med_price",align:"center",label:"\u0426\u0435\u043D\u0430(\u0440\u0443\u0431.)",field:e=>e.med_price,sortable:!0},{name:"med_expiration_date",align:"center",label:"\u0418\u0441\u0442\u0435\u0447\u0435\u043D\u0438\u0435 \u0441\u0440\u043E\u043A\u0430 \u0433\u043E\u0434\u043D\u043E\u0441\u0442\u0438",field:e=>e.med_expiration_date,sortable:!0},{name:"med_receipts",align:"center",label:"\u0414\u0430\u0442\u0430 \u043F\u043E\u0441\u0442\u0443\u043F\u043B\u0435\u043D\u0438\u044F",field:e=>e.med_receipts,sortable:!0},{name:"s_name",align:"center",label:"\u041F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A",field:e=>e.s_name,sortable:!0},{name:"delete",label:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u0430",align:"center"}]});function m(){_.get(`https://zdorovie.space/api/v1/warehouse/${C.params.w_id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(e=>{a.w_id=e.data.warehouse_info.w_id,a.w_address=e.data.warehouse_info.w_address,a.w_director=e.data.warehouse_info.w_director,a.w_phone_number=e.data.warehouse_info.w_phone_number,a.medication=e.data.medications}).catch(function(e){returnToLigonPage()})}function k(){for(let e=0;e<a.selected_med.length;e++)_.post("https://zdorovie.space/api/v1/medication-warehouse",{w_id:a.w_id,med_id:a.selected_med[e]});a.addCard=!1,m()}function y(e){_.delete(`https://zdorovie.space/api/v1/medication-warehouse/${a.w_id}-${e}`).then(async()=>{m()})}return W(async()=>{m(),a.all_medication=await v()}),(e,l)=>(n(),i(P,{class:"q-pa-md"},{default:r(()=>[d(s,{color:"primary",icon:"warehouse",label:"\u041A \u0441\u043A\u043B\u0430\u0434\u0430\u043C",onClick:l[0]||(l[0]=o=>p(x).push({name:"Warehouse"}))}),t("div",E,[t("span",null,[h("\u0421\u043A\u043B\u0430\u0434 \u043F\u043E \u0430\u0434\u0440\u0435\u0441\u0443: "),t("b",null,f(a.w_address),1)]),t("span",null,[h("\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430: "),t("b",null,f(a.w_phone_number),1)]),t("span",null,[h("\u0414\u0438\u0440\u0435\u043A\u0442\u043E\u0440: "),t("b",null,f(a.w_director),1)])]),t("div",F,[a.medication.length==0?(n(),g("div",H,j)):c("",!0),a.medication.length!=0?(n(),g("div",G,[d(V,{title:"\u041C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u044B \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435",rows:a.medication,columns:a.columns,"row-key":"name"},{"body-cell-delete":r(o=>[d(Q,{props:o},{default:r(()=>[p(w)()?(n(),i(s,{key:0,color:"red",icon:"delete",onClick:b=>y(o.row.med_id)},null,8,["onClick"])):c("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])):c("",!0)]),t("div",K,[p(w)()?(n(),i(s,{key:0,color:"green",icon:"add",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0435\u0434\u0438\u043A\u0430\u043C\u0435\u043D\u0442\u043E\u0432 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434",onClick:l[1]||(l[1]=o=>(a.addCard=!0,a.selected_med=[]))})):c("",!0)]),d(M,{modelValue:a.addCard,"onUpdate:modelValue":l[4]||(l[4]=o=>a.addCard=o),persistent:""},{default:r(()=>[d(A,null,{default:r(()=>[d(N,{class:"column"},{default:r(()=>[t("div",Z,[d($,{icon:"medication",color:"green","text-color":"white"}),J]),t("div",O,[(n(!0),g(R,null,L(a.all_medication,o=>(n(),i(q,{key:o.med_id,val:o.med_id,modelValue:a.selected_med,"onUpdate:modelValue":l[2]||(l[2]=b=>a.selected_med=b),label:o.med_name},null,8,["val","modelValue","label"]))),128))])]),_:1}),d(B,{align:"right"},{default:r(()=>[S(d(s,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"red"},null,512),[[z]]),a.selected_med.length!=0?(n(),i(s,{key:0,flat:"",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",color:"green",onClick:l[3]||(l[3]=o=>k())})):c("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ie as default};
